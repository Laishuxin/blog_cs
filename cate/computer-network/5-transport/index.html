<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>计算机网络 - 传输层 | Ru Shui</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/blog_cs/assets/img/logo.png">
    <link rel="manifest" href="/blog_cs/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="To Build Amazing Things !">
    <meta property="og:url" content="/blog_cs/cate/computer-network/5-transport.html">
    <meta property="og:site_name" content="Ru Shui">
    <meta property="og:title" content="计算机网络 - 传输层">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Ru Shui">
    <meta property="article:author" content="ru shui">
    <meta property="article:tag" content="computer network">
    <meta property="article:published_time" content="2021-09-27T00:00:00.000Z">
    <meta name="keywords" content="backend computer science">
    <meta name="author" content="ru shui">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/blog_cs/assets/css/0.styles.c0f28275.css" as="style"><link rel="preload" href="/blog_cs/assets/js/app.16bd55a2.js" as="script"><link rel="preload" href="/blog_cs/assets/js/layout-Layout.05aaa927.js" as="script"><link rel="preload" href="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.4b319992.js" as="script"><link rel="preload" href="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.4e62ce68.js" as="script"><link rel="preload" href="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout.6d1cfc91.js" as="script"><link rel="preload" href="/blog_cs/assets/js/page-计算机网络-传输层.940184bb.js" as="script"><link rel="prefetch" href="/blog_cs/assets/js/44.d134d706.js"><link rel="prefetch" href="/blog_cs/assets/js/45.eef8e3be.js"><link rel="prefetch" href="/blog_cs/assets/js/46.cfe5b283.js"><link rel="prefetch" href="/blog_cs/assets/js/47.46ba4682.js"><link rel="prefetch" href="/blog_cs/assets/js/48.2d7eb269.js"><link rel="prefetch" href="/blog_cs/assets/js/layout-Blog.286edd81.js"><link rel="prefetch" href="/blog_cs/assets/js/layout-NotFound.d696089a.js"><link rel="prefetch" href="/blog_cs/assets/js/layout-Slide.2ea672bd.js"><link rel="prefetch" href="/blog_cs/assets/js/page--38ab1f94.0ee91aa9.js"><link rel="prefetch" href="/blog_cs/assets/js/page--5e8d4d74.d527bf01.js"><link rel="prefetch" href="/blog_cs/assets/js/page--604125d4.98b6061f.js"><link rel="prefetch" href="/blog_cs/assets/js/page--aebf9a98.4de74a90.js"><link rel="prefetch" href="/blog_cs/assets/js/page--c12d42ec.320d7a0a.js"><link rel="prefetch" href="/blog_cs/assets/js/page-InformationStorage.4384310d.js"><link rel="prefetch" href="/blog_cs/assets/js/page-IntegerRepresentations.b0b42886.js"><link rel="prefetch" href="/blog_cs/assets/js/page-about.d3bf3112.js"><link rel="prefetch" href="/blog_cs/assets/js/page-csapp.fe293514.js"><link rel="prefetch" href="/blog_cs/assets/js/page-分类.c2ac9436.js"><link rel="prefetch" href="/blog_cs/assets/js/page-数据结构与算法-二分.2da042c8.js"><link rel="prefetch" href="/blog_cs/assets/js/page-数据结构与算法-前缀和和差分.5ec19ad9.js"><link rel="prefetch" href="/blog_cs/assets/js/page-数据结构与算法-排序.2e430056.js"><link rel="prefetch" href="/blog_cs/assets/js/page-数据结构与算法-高精度算法.8654db28.js"><link rel="prefetch" href="/blog_cs/assets/js/page-数据结构与算法.167704e2.js"><link rel="prefetch" href="/blog_cs/assets/js/page-计算机网络-http.ccef104d.js"><link rel="prefetch" href="/blog_cs/assets/js/page-计算机网络-链路层.97d0e551.js"><link rel="prefetch" href="/blog_cs/assets/js/page-计算机网络.a73822f1.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-单例模式.ae87fd95.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-原型模式.e73be0f1.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-工厂模式.f81efa2f.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-建造者模式（生成器模式）.b000530b.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-模板模式.b6b4708a.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-策略模式.7bdc8213.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-组合模式.3aa54ac1.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-装饰者模式.7887cd58.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-观察者模式.62b37d84.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-设计原则.bbb33c17.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-迭代器模式.5a74e9b0.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式-适配器模式.970d96e8.js"><link rel="prefetch" href="/blog_cs/assets/js/page-设计模式.28e3cb91.js"><link rel="prefetch" href="/blog_cs/assets/js/page-首页.a1e93793.js"><link rel="prefetch" href="/blog_cs/assets/js/vendors~photo-swipe.c256e8d9.js"><link rel="prefetch" href="/blog_cs/assets/js/vendors~reveal.58127042.js">
    <link rel="stylesheet" href="/blog_cs/assets/css/0.styles.c0f28275.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><button class="sidebar-button"><span class="icon"></span></button> <a href="/blog_cs/" class="home-link router-link-active"><img src="/blog_cs/assets/img/logo.png" alt="Ru Shui" class="logo"> <!----> <span class="site-name can-hide">Ru Shui</span></a> <div class="links"><button class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><a href="#" class="default-theme"></a></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="switch"><input id="switch" type="checkbox" checked="checked" class="switch-input"> <label for="switch" class="label"><span class="label-content"></span></label></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog_cs/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><a href="/blog_cs/category/" class="nav-link"><!---->
  分类
</a></div><div class="nav-item"><a href="/blog_cs/tag/" class="nav-link"><!---->
  标签
</a></div><div class="nav-item"><a href="/blog_cs/timeline/" class="nav-link"><!---->
  归档
</a></div><div class="nav-item"><a href="/blog_cs/about/" class="nav-link"><!---->
  关于
</a></div></nav> <!----> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info"><div data-balloon-pos="" class="blogger"><img property="image" alt="Blogger Avatar" src="/blog_cs/assets/img/logo.png" class="avatar"> <div property="name" class="name">ru shui</div> <!----></div> <div class="num-wrapper"><div><div class="num">26</div> <div>Articles</div></div> <div><div class="num">7</div> <div>Category</div></div> <div><div class="num">18</div> <div>Tags</div></div> <div><div class="num">26</div> <div>Timeline</div></div></div> <!----></div> <hr>  <nav class="sidebar-nav-links"><div class="nav-item"><a href="/blog_cs/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><a href="/blog_cs/category/" class="nav-link"><!---->
  分类
</a></div><div class="nav-item"><a href="/blog_cs/tag/" class="nav-link"><!---->
  标签
</a></div><div class="nav-item"><a href="/blog_cs/timeline/" class="nav-link"><!---->
  归档
</a></div><div class="nav-item"><a href="/blog_cs/about/" class="nav-link"><!---->
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog_cs/cate/computer-network/1-application-http/" class="sidebar-link">计算机网络 - http</a></li><li><a href="/blog_cs/cate/computer-network/3-link/" class="sidebar-link">计算机网络 - 链路层</a></li><li><a href="/blog_cs/cate/computer-network/5-transport/" aria-current="page" class="active sidebar-link">计算机网络 - 传输层</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#传输层概述" class="sidebar-link">传输层概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#传输层的功能" class="sidebar-link heading3">传输层的功能</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#传输层分用的原理" class="sidebar-link heading3">传输层分用的原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#tcp-协议" class="sidebar-link">TCP 协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#报文段格式" class="sidebar-link heading3">报文段格式</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#控制位的含义" class="sidebar-link heading3">控制位的含义</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#连接建立-三次握手" class="sidebar-link heading3">连接建立 - 三次握手</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#连接的释放-四次挥手" class="sidebar-link heading3">连接的释放 - 四次挥手</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#可靠传输" class="sidebar-link heading3">可靠传输</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#流量控制" class="sidebar-link heading3">流量控制</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#拥塞控制" class="sidebar-link heading3">拥塞控制</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#udp-协议" class="sidebar-link">UDP 协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#udp-的首部格式" class="sidebar-link heading3">UDP 的首部格式</a></li><li class="sidebar-sub-header"><a href="/blog_cs/cate/computer-network/5-transport/#udp-校验" class="sidebar-link heading3">UDP 校验</a></li></ul></li></ul></li></ul> </aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/blog_cs/cate/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">分类</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/blog_cs/cate/computer-network/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">计算机网络</span></a> <meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/blog_cs/cate/computer-network/5-transport/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">计算机网络 - 传输层</span></a> <meta property="position" content="3"></li></ol></nav>  <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">计算机网络 - 传输层</span></h1> <div class="page-info"><!----> <span aria-label="Author🖊" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">ru shui</span></span><!----><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-09-27 </span></span><span role="navigation" aria-label="Category🌈" data-balloon-pos="down" class="category-info enable"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon category-icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zm-.854 446.486H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zm446.371-446.486h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zm136.293 813.51H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z" fill="currentColor"></path></svg> <span property="articleSection">Computer network</span></span><span aria-label="Tags🏷" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">Computer network</span></li><li class="tag clickable tag1"><span role="navigation">Transport</span></li> <meta property="keywords" content="Computer network,Transport"></ul></span><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 8 min</span> <meta property="timeRequired" content="PT8M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#传输层概述" class="anchor-link heading2"><div>传输层概述</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#传输层的功能" class="anchor-link heading3"><div>传输层的功能</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#传输层分用的原理" class="anchor-link heading3"><div>传输层分用的原理</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#tcp-协议" class="anchor-link heading2"><div>TCP 协议</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#报文段格式" class="anchor-link heading3"><div>报文段格式</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#控制位的含义" class="anchor-link heading3"><div>控制位的含义</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#连接建立-三次握手" class="anchor-link heading3"><div>连接建立 - 三次握手</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#连接的释放-四次挥手" class="anchor-link heading3"><div>连接的释放 - 四次挥手</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#可靠传输" class="anchor-link heading3"><div>可靠传输</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#流量控制" class="anchor-link heading3"><div>流量控制</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#拥塞控制" class="anchor-link heading3"><div>拥塞控制</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#udp-协议" class="anchor-link heading2"><div>UDP 协议</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#udp-的首部格式" class="anchor-link heading3"><div>UDP 的首部格式</div></a></li><li class="anchor"><a href="/blog_cs/cate/computer-network/5-transport/#udp-校验" class="anchor-link heading3"><div>UDP 校验</div></a></li></ul></div></aside></div> <div class="theme-default-content content__default"><h2 id="传输层概述"><a href="#传输层概述" class="header-anchor">#</a> 传输层概述</h2> <p>传输层位于 OSI 参考模型的第四层。位于五层体系结构中的第 4 层，是主机
采用的层次。</p> <p>在五层体系中，传输层位于网络层和应用层之间，可以使用下层（网络层）提供
的服务，同时，为上层（应用层）提供服务。</p> <h3 id="传输层的功能"><a href="#传输层的功能" class="header-anchor">#</a> 传输层的功能</h3> <ol><li>提供进程与进程之间逻辑通信。</li> <li>复用和分用。
<ul><li>复用：发送方不同的进程都可以使用同一个传输层协议传送数据。</li> <li>分用：接收方的传输层在剥去报文首部后能够把这些数据正确交付到目的
进程.</li></ul></li> <li>对收到的报文进行差错检测。</li></ol> <h3 id="传输层分用的原理"><a href="#传输层分用的原理" class="header-anchor">#</a> 传输层分用的原理</h3> <p>在网络层中，我们可以通过 mac 地址来标识唯一的主机。而在
传输层中，我们可以通过端口号来标识唯一的进程。</p> <p>通过 socket 我们就可以标识网络中的唯一一个主机以及上面的进程。
( socket = (ip, port) )</p> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-13-06-30.4b21869c.png" alt="img" style="width:80%;"></div> <h2 id="tcp-协议"><a href="#tcp-协议" class="header-anchor">#</a> TCP 协议</h2> <p>TCP 协议是一种<strong>面向连接</strong>的传输控制协议。
使用 TCP 传输数据之前都必须建立连接，数据传送结束后要释放连接。
不提供广播或多播服务。由于 TCP 要提供<strong>可靠传输</strong>的<strong>面向连接</strong>
的传输服务，因为不可避免增加了许多开销，如：确认、流量控制、计时器
以及连接管理等。</p> <p>特点：</p> <ol><li><p>TCP 是面向连接（虚连接）的传输层协议。</p></li> <li><p>每一条 TCP 连接只能有两个断电，每一条 TCP 练级额只能是点对点的。</p></li> <li><p>TCP 提供可靠交付的服务，无差错、不丢失、不重复、按序到达（可靠有序，不丢不重）</p></li> <li><p>TCP 提供全双工通信。</p> <ul><li>发送缓存：准备发送的数据和已经发送但未接收到确认的数据。</li> <li>接收缓存：按需达到但尚未接受应用程序读取的数据和不按序到达的数据。</li></ul></li> <li><p>TCP 面向字节流。TCP 把应用层交付下来的数据看成仅仅是一连串的无结构的<strong>字节流</strong>。</p></li></ol> <h3 id="报文段格式"><a href="#报文段格式" class="header-anchor">#</a> 报文段格式</h3> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-14-52-43.2a40f3e9.png" alt="img" style="width:80%;"></div> <p>TCP 采用的是 0 比特填充法来确保 TCP 报文段是 4 bytes 的整数倍。</p> <p>TCP 报文段<strong>首部</strong>的长度为 20 bytes 的固定首部 + 选项字段。</p> <p>TCP 报文段中每个字段的含义：</p> <table><thead><tr><th style="text-align:center;">字段</th> <th style="text-align:center;">大小</th> <th style="text-align:center;">解释</th></tr></thead> <tbody><tr><td style="text-align:center;">源端口号</td> <td style="text-align:center;">8 bits</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">目的端口号</td> <td style="text-align:center;">8 bits</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">序号</td> <td style="text-align:center;">32 bits</td> <td style="text-align:center;">在一个 TCP 连接中传送的字节流中的每一个字节都按照顺序编号，序号字段表示所要发送数据的<strong>第一个字节序号</strong></td></tr> <tr><td style="text-align:center;">确认号</td> <td style="text-align:center;">32 bits</td> <td style="text-align:center;"><strong>期望</strong>收到对方下一个报文段的第一个数据字节序号。若确认号为 N，则证明到 序号 N - 1 为止的所有数据都已经确认收到</td></tr> <tr><td style="text-align:center;">数据偏移（首部长度）</td> <td style="text-align:center;">4 bits</td> <td style="text-align:center;">数据偏移字段也就首部长度字段。TCP 报文段的<strong>数据</strong>起始处距离 TCP 报文段的起始处距离，是以 4 bytes 为单位。例如：TCP 数据偏移字段为 b1111，则 TCP 报文首部长为 15 × 4 = 60 bytes</td></tr> <tr><td style="text-align:center;">保留</td> <td style="text-align:center;">7 bits</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">控制位</td> <td style="text-align:center;">6 bits</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">窗口</td> <td style="text-align:center;">16 bits</td> <td style="text-align:center;">发送方的接收窗口</td></tr> <tr><td style="text-align:center;">检验和</td> <td style="text-align:center;">检验首部 + 数据，检验时需要加上 12 bits 的伪首部（和 UDP 一样，但是协议字段为 6）</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">紧急指针</td> <td style="text-align:center;">16 bits</td> <td style="text-align:center;">指出本报文段中紧急数据的字节数。只有当 URG = 1 时才有效</td></tr> <tr><td style="text-align:center;">选项</td> <td style="text-align:center;"></td> <td style="text-align:center;">最大报文段长度 MSS、窗口扩大等</td></tr></tbody></table> <h3 id="控制位的含义"><a href="#控制位的含义" class="header-anchor">#</a> 控制位的含义</h3> <table><thead><tr><th style="text-align:center;">控制位</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">URG</td> <td style="text-align:center;">紧急位，表明次报文段中有紧急的数据，是高优先级的数据，应尽快传送，不用在缓存中排队，一般配合紧急指针字段使用</td></tr> <tr><td style="text-align:center;">ACK</td> <td style="text-align:center;">确认位。 当 ACK = 1 时确认号有效，在连接建立后所有传送的报文段都必须把 ACK 置为 1</td></tr> <tr><td style="text-align:center;">PSH</td> <td style="text-align:center;">推送位。当 PSH = 1 时，表明接收方尽快交付接收应用进程，不需要等到缓存填满再向上交付</td></tr> <tr><td style="text-align:center;">RST</td> <td style="text-align:center;">复位。当 RST = 1 时，表明 TCP 连接出现严重差错，必须释放连接，然后再重新建立连接</td></tr> <tr><td style="text-align:center;">SYN</td> <td style="text-align:center;">同步位。当 SYN = 1 时，表明是一个连接请求或连接接收报文</td></tr> <tr><td style="text-align:center;">FIN</td> <td style="text-align:center;">终止位。当 FIN = 1 时，表明该报文段发送方数据已发送完，要求释放连接</td></tr></tbody></table> <h3 id="连接建立-三次握手"><a href="#连接建立-三次握手" class="header-anchor">#</a> 连接建立 - 三次握手</h3> <p>TCP 连接建立的三个阶段：</p> <ol><li>连接建立</li> <li>数据传送</li> <li>连接释放</li></ol> <p>TCP 的连接过程如下图：</p> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-15-31-25.393e014b.png" alt="img" style="width:80%;"></div> <p>(小写为 TCP 数据报中的字段，大写为 TCP 数据报中控制字段的控制位)</p> <ol><li>客户端发送<strong>连接请求</strong>报文段，无应用层数据。
<ul><li>SYN = 1，seq = x（随机生成）</li></ul></li> <li>服务端接收到客户端的连接请求，为该 TCP 连接<strong>分配缓存和变量</strong>，并向客户端返回<strong>确认报文段</strong>，允许连接，无应用层数据。
<ul><li>SYN = 1, ACK = 1, seq = y(随机), ack = x + 1</li></ul></li> <li>客户端接收到服务器的响应，为该 TCP 连接<strong>分配缓存和变量</strong>，并向服务器返回确认的确认，可以携带数据。
<ul><li>SYN = 0, ACK = 1, seq = x + 1, ack = y + 1
(连接已经建立，SYN = 0)</li></ul></li></ol> <h3 id="连接的释放-四次挥手"><a href="#连接的释放-四次挥手" class="header-anchor">#</a> 连接的释放 - 四次挥手</h3> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-15-46-04.3a59f7e7.png" alt="img" style="width:80%;"></div> <ol><li><p>客户端发送<strong>连接释放报文段</strong>，停止发送数据，主动关闭 TCP 连接。</p> <ul><li>FIN = 1, seq = u</li></ul></li> <li><p>服务器返回一个确认报文段，客户端到服务器这个方向（双工中其中一个）的连接就释放了，进入一个半关闭状态。</p> <ul><li>ACK = 1, seq = v, ack = u + 1</li></ul></li> <li><p>服务器发送完数据，就发送连接释放报文段 P 请求，主动关闭 TCP 连接。</p> <ul><li>FIN = 1, ACK = 1, seq = w, ack = u + 1</li></ul></li> <li><p>客户端返回一个确认报文段，再等到等待计时器的设置的 2MSL（最长报文段寿命）后，连接彻底关闭。</p> <ul><li>ACK = 1, seq = u + 1, ack = w + 1</li></ul></li></ol> <p>假设客户端响应服务器的报文段（最后一个）丢失了，服务器为了确认客户端
接收到连接释放的请求，服务器就会重新发送请求释放报文段。
如果没有这个 2MSL 的话，服务器就一直收不到这个响应就得一直发送连接释放的请求。</p> <h3 id="可靠传输"><a href="#可靠传输" class="header-anchor">#</a> 可靠传输</h3> <p>所谓的可靠传输指的是保证接收方进程从缓存中读取的字节流与发送方发送的字节流是完全一样的。</p> <p>TCP 实现可靠传输的机制为</p> <ol><li>校验</li> <li>序号</li> <li>确认</li> <li>重传</li></ol> <h3 id="流量控制"><a href="#流量控制" class="header-anchor">#</a> 流量控制</h3> <h3 id="拥塞控制"><a href="#拥塞控制" class="header-anchor">#</a> 拥塞控制</h3> <h2 id="udp-协议"><a href="#udp-协议" class="header-anchor">#</a> UDP 协议</h2> <p>UDP 协议是一种无连接的用户数据报协议。传送数据之前不需要建立连接
收到 UDP 报文段后也不需要给出任何确认。</p> <p>UDP 在 IP 数据报的基础上添加了很少的功能，即添加了复用分用和差错检测功能。</p> <p>UDP 的主要特点：</p> <ol><li>UDP 是无连接，减少开销和发送数据之前的时延。</li> <li>UDP 采用的是最大努力交付，即不保证可靠传输。</li> <li>UDP 是面向报文的，适合一次性传输少量的网络应用。（即，应用层给 UDP 多长的报文，UDP 就照样发送。即一次就发送一个完整的报文）</li> <li>UDP 没有拥塞控制，适合很多是实时网络应用。</li> <li>UDP 的首部开销比较小（8 bytes）。</li></ol> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-14-13-01.43f6e1b9.png" alt="img" style="width:80%;"></div> <h3 id="udp-的首部格式"><a href="#udp-的首部格式" class="header-anchor">#</a> UDP 的首部格式</h3> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-14-17-02.19b75c2a.png" alt="img" style="width:80%;"></div> <ol><li>16 位源端口号：可有可无。</li> <li>16 位的目的端口号：必须带上。</li> <li>16 位的 UDP 长度：UDP 用户数据报的<strong>整个</strong>长度。例如，UDP 数据的长度为 7 个字节，则 UDP 整个数据报的长度为 7 + 8 = 15 字节。</li> <li>16 位的 UDP 检验和：检测<strong>整个</strong> UDP 数据报是否有差错，有错就丢弃。（在分用时，如果找不到目的端口号，就丢弃报文，并向对方发送 ICMP “端口号不可达” 差错报告报文。</li></ol> <h3 id="udp-校验"><a href="#udp-校验" class="header-anchor">#</a> UDP 校验</h3> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-14-26-52.3c384be0.png" alt="img" style="width:80%;"></div> <p>UDP 伪首部的组成：</p> <table><thead><tr><th style="text-align:center;">字段编号</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td style="text-align:center;">0</td> <td style="text-align:center;">源 IP 地址</td></tr> <tr><td style="text-align:center;">1</td> <td style="text-align:center;">目的 IP 地址</td></tr> <tr><td style="text-align:center;">2</td> <td style="text-align:center;">全 0 的填充位</td></tr> <tr><td style="text-align:center;">3</td> <td style="text-align:center;">封装 UDP 报文的 IP 数据报首部协议字段</td></tr> <tr><td style="text-align:center;">4</td> <td style="text-align:center;">UDP 长度。包括 UDP 首部 8 bytes 和数据部分长度（不包括伪首部）</td></tr></tbody></table> <div style="text-align:center;"><img src="/blog_cs/assets/img/2021-09-29-14-33-53.7cb984d7.png" alt="img" style="width:80%;"></div> <p>在发送端处：</p> <ol><li>填上伪首部字段。</li> <li>全 0 填充检验和字段。</li> <li>全 0 填充数据部分，保证数据部分的长度为 4 bytes 的整数倍。</li> <li>首部 + 伪首部 + 数据部分 采用二进制反码的方式求合。</li> <li>把反码填入检验和中。</li> <li>去掉伪首部，发送数据。</li></ol> <p>在接收方处：</p> <ol><li>添加上伪首部</li> <li>伪首部 + 首部 + 数据部分采用二进制反码求合。（注意：这里首部的校验和是发送方计算过的）</li> <li>如果求合的结果全为 1 表示无差错。否则丢弃数据报或交付给应用层进行差错报告。</li></ol></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">October 16, 2021 13:45</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 56504759+Laishuxin@users.noreply.github.com" class="contributor">
          Laishuxin
        </span> <!----></span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog_cs/cate/computer-network/3-link/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        计算机网络 - 链路层
      </a></span> <!----></p></div> <!----> </main> <footer class="footer-wrapper"><!----> <div class="footer"><h2 style="width:100%; min-width: 100%;">Ru Shui</h2></div> <div class="copyright">MIT Licensed | Copyright © 2021-present Ru Shui</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close (Esc)" class="pswp__button pswp__button--close"></button> <button title="Share" class="pswp__button pswp__button--share"></button> <button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/blog_cs/assets/js/app.16bd55a2.js" defer></script><script src="/blog_cs/assets/js/layout-Layout.05aaa927.js" defer></script><script src="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.4b319992.js" defer></script><script src="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.4e62ce68.js" defer></script><script src="/blog_cs/assets/js/vendors~layout-Blog~layout-Layout.6d1cfc91.js" defer></script><script src="/blog_cs/assets/js/page-计算机网络-传输层.940184bb.js" defer></script>
  </body>
</html>
